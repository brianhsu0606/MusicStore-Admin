import{u as b}from"./useCrud-CEQkmIa7.js";import{h as g,k as c,r as G,s as d,p as J,b as m,w as l,e as r,v as K,o as i,d as a,x,a as s,j as y,y as A,t as _,c as Q,F as R,l as T,n as W}from"./index-CjIOrfGk.js";const X={class:"overflow-auto"},Z={class:"flex flex-col sm:flex-row gap-4 mb-4 overflow-auto"},ee={class:"flex items-center gap-4"},te={class:"text-xl text-gray-500 font-medium"},ae={class:"overflow-auto"},oe={class:"flex justify-between items-center min-w-[350px]"},le={class:"text-xl font-medium"},ie={__name:"Home",setup(se){const{loading:h,list:D,fetchData:k}=b({getApi:g.getProductList}),C=c(()=>D.value.slice(0,5)),O=c(()=>{const o=D.value.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.quantity,e),{});return Object.entries(o).map(([e,t])=>({category:e,quantity:t}))}),{loading:j,list:w,fetchData:q}=b({getApi:g.getOrderList}),V=c(()=>w.value.filter(o=>o.status==="processing").length),u=G(30),z=c(()=>{const o=d();return w.value.filter(e=>d(e.createdAt).isAfter(o.subtract(u.value,"day")))}),Y=c(()=>{const o={};for(let e=0;e<u.value;e++){const t=d().subtract(e,"day").format("YYYY-MM-DD");o[t]=0}return z.value.forEach(e=>{const t=d(e.createdAt).format("YYYY-MM-DD");o[t]!==void 0&&o[t]++}),{labels:Object.keys(o).reverse(),values:Object.values(o).reverse()}}),B=c(()=>({tooltip:{},xAxis:{type:"category",data:Y.value.labels,axisLabel:{rotate:45}},yAxis:{type:"value"},series:[{name:"訂單數量",type:"bar",data:Y.value.values,itemStyle:{color:"#b0c4d4"}}]})),{list:S,fetchData:P}=b({getApi:g.getMemberList}),E=[{icon:"User",bg:"bg-green-400",title:"會員人數：",count:c(()=>S.value.length)},{icon:"Document",bg:"bg-blue-400",title:"未出貨訂單：",count:V}],F=(o,e,t)=>d(t).format("YYYY-MM-DD");return J(()=>{k(),P(),q()}),(o,e)=>{const t=r("el-table-column"),L=r("el-table"),p=r("el-card"),M=r("el-col"),N=r("el-icon"),f=r("el-option"),U=r("el-select"),H=r("v-chart"),I=r("el-row"),v=K("loading");return i(),m(I,{gutter:20},{default:l(()=>[a(M,{xs:24,sm:24,md:12,lg:10},{default:l(()=>[x((i(),m(p,{"element-loading-text":"載入中，請稍候...",class:"mb-4"},{default:l(()=>[e[1]||(e[1]=s("h3",{class:"mb-2"},"最近 5 筆進貨",-1)),s("div",X,[a(L,{data:C.value,stripe:"",class:"min-w-[380px]"},{default:l(()=>[a(t,{prop:"createdAt",label:"進貨日期","min-width":"50",formatter:F}),a(t,{prop:"name",label:"商品名稱"}),a(t,{prop:"quantity",label:"數量","min-width":"26"})]),_:1},8,["data"])])]),_:1,__:[1]})),[[v,y(h)]]),x((i(),m(p,{"element-loading-text":"載入中，請稍候...",class:"mb-4"},{default:l(()=>[e[2]||(e[2]=s("h3",{class:"mb-2"},"商品總庫存",-1)),a(L,{data:O.value,stripe:""},{default:l(()=>[a(t,{prop:"category",label:"分類"}),a(t,{prop:"quantity",label:"庫存量"},{default:l(({row:n})=>[s("span",{class:A({"text-red-500 font-semibold":n.quantity<20})},_(n.quantity),3)]),_:1})]),_:1},8,["data"])]),_:1,__:[2]})),[[v,y(h)]])]),_:1}),a(M,{xs:24,sm:24,md:12,lg:14},{default:l(()=>[s("div",Z,[(i(),Q(R,null,T(E,(n,$)=>a(p,{key:$,class:"flex-1 min-w-[300px]"},{default:l(()=>[s("div",ee,[a(N,{size:50,class:A(`${n.bg} rounded-lg p-1`)},{default:l(()=>[(i(),m(W(n.icon)))]),_:2},1032,["class"]),s("div",null,[s("h3",null,_(n.title),1),s("p",te,_(n.count),1)])])]),_:2},1024)),64))]),x((i(),m(p,{"element-loading-text":"載入中，請稍候..."},{default:l(()=>[s("div",ae,[s("header",oe,[s("h3",le,"最近 "+_(u.value)+" 天的訂單數量",1),a(U,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),size:"large",style:{width:"150px"}},{default:l(()=>[a(f,{label:"最近 7 天",value:7}),a(f,{label:"最近 14 天",value:14}),a(f,{label:"最近 30 天",value:30})]),_:1},8,["modelValue"])]),a(H,{option:B.value,autoresize:"",class:"h-[400px] min-w-[350px]"},null,8,["option"])])]),_:1})),[[v,y(j)]])]),_:1})]),_:1})}}};export{ie as default};
