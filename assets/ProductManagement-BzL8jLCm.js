import{u as le,a as oe}from"./usePagination-wT7Kd-rM.js";import{u as ae}from"./useCrud-AybAH7Z3.js";import{r as _,z as re,s as A,h as b,k as ne,p as ie,c as v,a as y,d as l,w as o,j as i,e as r,x as ue,v as de,b as q,F as V,o as m,g as p,l as D}from"./index-B1YkKidd.js";const se={class:"mb-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"},me={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"},pe={class:"overflow-auto"},be={__name:"ProductManagement",setup(ce){const{dialogWidth:P}=le(),k=["全部商品","木吉他","電吉他","音箱","配件","吉他弦"],U=k.slice(1),c=_("全部商品"),C=_(),a=re({visible:!1,isEdit:!1,title:"",form:{createdAt:"",name:"",category:"",price:0,quantity:0}}),L={createdAt:[{required:!0,message:"請選擇進貨日期",trigger:"blur"}],name:[{required:!0,message:"請輸入商品名稱",trigger:"blur"}],category:[{required:!0,message:"請選擇商品分類",trigger:"blur"}],price:[{required:!0,message:"請輸入商品價格",trigger:"blur"}],quantity:[{required:!0,message:"請輸入商品數量",trigger:"blur"}]},{loading:h,list:z,fetchData:j,handleAdd:B,handleEdit:N,handleDelete:$,submit:E}=ae({getApi:b.getProductList,addApi:b.addProduct,updateApi:b.updateProduct,deleteApi:b.deleteProduct,formRef:C,dialog:a,defaultForm:{createdAt:A().format("YYYY-MM-DD"),name:"",category:"",price:0,quantity:0},getTitle:n=>n==="add"?"新增商品":"編輯商品"}),f=_(""),g=_(""),Y=ne(()=>{let n=z.value;if(c.value!=="全部商品"&&(n=n.filter(e=>e.category===c.value)),g.value.trim()){const e=g.value.toLowerCase();n=n.filter(u=>u.name.toLowerCase().includes(e))}return f.value&&(n=n.filter(e=>e.createdAt&&e.createdAt.startsWith(f.value))),n}),{currentPage:F,pageSize:T,pagedList:W,handlePageChange:R}=oe(Y,8),S=(n,e,u)=>A(u).format("YYYY-MM-DD"),I=n=>"NT$ "+n.price.toLocaleString();return ie(()=>{j()}),(n,e)=>{const u=r("el-button"),w=r("el-date-picker"),x=r("el-input"),O=r("el-tab-pane"),d=r("el-table-column"),G=r("el-table"),H=r("el-pagination"),J=r("el-tabs"),s=r("el-form-item"),K=r("el-option"),Q=r("el-select"),M=r("el-input-number"),X=r("el-form"),Z=r("el-dialog"),ee=de("loading");return m(),v(V,null,[y("header",se,[l(u,{onClick:i(B),type:"primary"},{default:o(()=>e[10]||(e[10]=[p("新增商品")])),_:1},8,["onClick"]),y("div",me,[l(w,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),type:"month",size:"large",format:"YYYY-MM","value-format":"YYYY-MM",placeholder:"選擇月份"},null,8,["modelValue"]),l(x,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),"prefix-icon":"search",placeholder:"請輸入商品名稱"},null,8,["modelValue"])])]),y("div",pe,[ue((m(),q(J,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),type:"border-card",class:"mb-4 min-w-[900px]","element-loading-text":"載入中，請稍候..."},{default:o(()=>[(m(),v(V,null,D(k,t=>l(O,{key:t,label:t,name:t},null,8,["label","name"])),64)),l(G,{data:i(W),class:"mb-4",stripe:""},{default:o(()=>[l(d,{prop:"createdAt",label:"進貨日期","min-width":"90",formatter:S}),l(d,{prop:"name",label:"商品名稱","min-width":"150"}),l(d,{prop:"category",label:"分類","min-width":"70"}),l(d,{prop:"price",label:"價格",sortable:"",formatter:I}),l(d,{prop:"quantity",label:"數量","min-width":"50"}),l(d,{label:"操作","min-width":"100"},{default:o(({row:t})=>[l(u,{onClick:te=>i(N)(t),type:"primary"},{default:o(()=>e[11]||(e[11]=[p("編輯")])),_:2},1032,["onClick"]),l(u,{onClick:te=>i($)(t.id),type:"danger"},{default:o(()=>e[12]||(e[12]=[p("刪除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(H,{background:"",layout:"prev, pager, next","page-size":i(T),"current-page":i(F),total:Y.value.length,onCurrentChange:i(R)},null,8,["page-size","current-page","total","onCurrentChange"])]),_:1},8,["modelValue"])),[[ee,i(h)]])]),l(Z,{modelValue:a.visible,"onUpdate:modelValue":e[9]||(e[9]=t=>a.visible=t),title:a.title,width:i(P)},{footer:o(()=>[l(u,{onClick:e[8]||(e[8]=t=>a.visible=!1)},{default:o(()=>e[13]||(e[13]=[p("取消")])),_:1}),l(u,{onClick:i(E),type:"primary"},{default:o(()=>e[14]||(e[14]=[p("確認")])),_:1},8,["onClick"])]),default:o(()=>[l(X,{model:a.form,rules:L,ref_key:"formRef",ref:C,"label-width":"80px","label-position":"right"},{default:o(()=>[l(s,{prop:"createdAt",label:"進貨日期"},{default:o(()=>[l(w,{modelValue:a.form.createdAt,"onUpdate:modelValue":e[3]||(e[3]=t=>a.form.createdAt=t),"value-format":"YYYY-MM-DD",placeholder:"請選擇日期"},null,8,["modelValue"])]),_:1}),l(s,{prop:"name",label:"商品名稱"},{default:o(()=>[l(x,{modelValue:a.form.name,"onUpdate:modelValue":e[4]||(e[4]=t=>a.form.name=t)},null,8,["modelValue"])]),_:1}),l(s,{prop:"category",label:"分類"},{default:o(()=>[l(Q,{modelValue:a.form.category,"onUpdate:modelValue":e[5]||(e[5]=t=>a.form.category=t),placeholder:"請選擇分類"},{default:o(()=>[(m(!0),v(V,null,D(i(U),t=>(m(),q(K,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{prop:"price",label:"價格"},{default:o(()=>[l(M,{modelValue:a.form.price,"onUpdate:modelValue":e[6]||(e[6]=t=>a.form.price=t),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),l(s,{prop:"quantity",label:"數量"},{default:o(()=>[l(M,{modelValue:a.form.quantity,"onUpdate:modelValue":e[7]||(e[7]=t=>a.form.quantity=t),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","width"])],64)}}};export{be as default};
