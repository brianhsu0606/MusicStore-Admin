import{u as N}from"./useCrud-ImgxaMOx.js";import{u as Y,h as m,p as B,x as E,v as L,j as d,b as i,w as l,e as n,o as c,a as S,d as t,g as f,t as j,m as A,s as $,E as g}from"./index-CoyXvUyw.js";const I={class:"overflow-auto"},z={__name:"UserManagement",setup(R){const u=Y(),{loading:h,list:V,fetchData:v,handleDelete:y}=N({getApi:m.getUserList,deleteApi:m.deleteUser}),U=async(r,o)=>{try{await m.updateUser(r,{role:o}),g.success("更新用戶身份成功")}catch(e){g.error(e)}},_=(r,o,e)=>e?$(e).format("YYYY-MM-DD"):"-",C=(r,o,e)=>e||"-";return B(()=>{v()}),(r,o)=>{const e=n("el-table-column"),p=n("el-option"),b=n("el-select"),D=n("el-button"),k=n("el-table"),x=n("el-card"),M=L("loading");return E((c(),i(x,{"element-loading-text":"載入中，請稍候..."},{default:l(()=>[S("div",I,[t(k,{data:d(V),stripe:"",class:"min-w-[1050px]"},{default:l(()=>[t(e,{prop:"employeeId",label:"員工編號"}),t(e,{prop:"name",label:"姓名"}),t(e,{prop:"gender",label:"性別"},{default:l(({row:a})=>[f(j(a.gender==="male"?"男":a.gender==="female"?"女":a.gender==="others"?"其他":"-"),1)]),_:1}),t(e,{prop:"email",label:"信箱",formatter:C}),t(e,{prop:"birth",label:"生日",formatter:_}),t(e,{prop:"lastLogin",label:"最後登入日期",formatter:_}),t(e,{label:"身份",width:"150"},{default:l(({row:a})=>[a.role==="superadmin"?(c(),i(b,{key:0,modelValue:a.role,"onUpdate:modelValue":s=>a.role=s,disabled:""},{default:l(()=>[t(p,{label:"超級管理員",value:"superadmin"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(c(),i(b,{key:1,modelValue:a.role,"onUpdate:modelValue":s=>a.role=s,onChange:s=>U(a.id,a.role),disabled:a.id===d(u).id},{default:l(()=>[t(p,{label:"職員",value:"user"}),t(p,{label:"管理員",value:"admin"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange","disabled"]))]),_:1}),t(e,{label:"操作"},{default:l(({row:a})=>[a.role!=="superadmin"?(c(),i(D,{key:0,onClick:s=>d(y)(a.id),disabled:a.id===d(u).id,type:"danger"},{default:l(()=>o[0]||(o[0]=[f(" 刪除 ")])),_:2},1032,["onClick","disabled"])):A("",!0)]),_:1})]),_:1},8,["data"])])]),_:1})),[[M,d(h)]])}}};export{z as default};
