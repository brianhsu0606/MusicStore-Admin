import{u as g}from"./useCrud-AybAH7Z3.js";import{h as v,k as c,r as G,s as d,p as J,b as m,w as o,e as r,v as K,o as i,d as a,x as y,a as s,j as x,y as M,t as _,c as Q,F as R,l as T,n as W}from"./index-B1YkKidd.js";const X={class:"overflow-auto"},Z={class:"flex flex-col sm:flex-row gap-4 mb-4"},ee={class:"flex items-center gap-4"},te={class:"text-xl text-gray-500 font-medium"},ae={class:"flex justify-between items-center"},le={class:"text-xl font-medium"},ce={__name:"Home",setup(oe){const{loading:h,list:D,fetchData:k}=g({getApi:v.getProductList}),C=c(()=>D.value.slice(0,5)),O=c(()=>{const l=D.value.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+t.quantity,e),{});return Object.entries(l).map(([e,t])=>({category:e,quantity:t}))}),{loading:j,list:Y,fetchData:q}=g({getApi:v.getOrderList}),V=c(()=>Y.value.filter(l=>l.status==="processing").length),u=G(30),z=c(()=>{const l=d();return Y.value.filter(e=>d(e.createdAt).isAfter(l.subtract(u.value,"day")))}),w=c(()=>{const l={};for(let e=0;e<u.value;e++){const t=d().subtract(e,"day").format("YYYY-MM-DD");l[t]=0}return z.value.forEach(e=>{const t=d(e.createdAt).format("YYYY-MM-DD");l[t]!==void 0&&l[t]++}),{labels:Object.keys(l).reverse(),values:Object.values(l).reverse()}}),B=c(()=>({tooltip:{},xAxis:{type:"category",data:w.value.labels,axisLabel:{rotate:45}},yAxis:{type:"value"},series:[{name:"訂單數量",type:"bar",data:w.value.values,itemStyle:{color:"#b0c4d4"}}]})),{list:S,fetchData:P}=g({getApi:v.getMemberList}),E=[{icon:"User",bg:"bg-green-400",title:"會員人數：",count:c(()=>S.value.length)},{icon:"Document",bg:"bg-blue-400",title:"未出貨訂單：",count:V}],F=(l,e,t)=>d(t).format("YYYY-MM-DD");return J(()=>{k(),P(),q()}),(l,e)=>{const t=r("el-table-column"),L=r("el-table"),p=r("el-card"),A=r("el-col"),N=r("el-icon"),f=r("el-option"),U=r("el-select"),H=r("v-chart"),I=r("el-row"),b=K("loading");return i(),m(I,{gutter:20},{default:o(()=>[a(A,{xs:24,sm:24,md:12,lg:10},{default:o(()=>[y((i(),m(p,{"element-loading-text":"載入中，請稍候...",class:"mb-4"},{default:o(()=>[e[1]||(e[1]=s("h3",{class:"mb-2"},"最近 5 筆進貨",-1)),s("div",X,[a(L,{data:C.value,stripe:"",class:"min-w-[380px]"},{default:o(()=>[a(t,{prop:"createdAt",label:"進貨日期","min-width":"50",formatter:F}),a(t,{prop:"name",label:"商品名稱"}),a(t,{prop:"quantity",label:"數量","min-width":"26"})]),_:1},8,["data"])])]),_:1})),[[b,x(h)]]),y((i(),m(p,{"element-loading-text":"載入中，請稍候...",class:"mb-4"},{default:o(()=>[e[2]||(e[2]=s("h3",{class:"mb-2"},"商品總庫存",-1)),a(L,{data:O.value,stripe:""},{default:o(()=>[a(t,{prop:"category",label:"分類"}),a(t,{prop:"quantity",label:"庫存量"},{default:o(({row:n})=>[s("span",{class:M({"text-red-500 font-semibold":n.quantity<20})},_(n.quantity),3)]),_:1})]),_:1},8,["data"])]),_:1})),[[b,x(h)]])]),_:1}),a(A,{xs:24,sm:24,md:12,lg:14},{default:o(()=>[s("div",Z,[(i(),Q(R,null,T(E,(n,$)=>a(p,{key:$,class:"flex-1"},{default:o(()=>[s("div",ee,[a(N,{size:50,class:M(`${n.bg} rounded-lg p-1`)},{default:o(()=>[(i(),m(W(n.icon)))]),_:2},1032,["class"]),s("div",null,[s("h3",null,_(n.title),1),s("p",te,_(n.count),1)])])]),_:2},1024)),64))]),y((i(),m(p,{"element-loading-text":"載入中，請稍候..."},{default:o(()=>[s("header",ae,[s("h3",le,"最近 "+_(u.value)+" 天的訂單數量",1),a(U,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),size:"large",style:{width:"150px"}},{default:o(()=>[a(f,{label:"最近 7 天",value:7}),a(f,{label:"最近 14 天",value:14}),a(f,{label:"最近 30 天",value:30})]),_:1},8,["modelValue"])]),a(H,{option:B.value,autoresize:"",style:{height:"400px"}},null,8,["option"])]),_:1})),[[b,x(j)]])]),_:1})]),_:1})}}};export{ce as default};
