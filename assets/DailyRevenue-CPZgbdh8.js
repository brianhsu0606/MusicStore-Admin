import{u as I,r as g,z as J,s as c,h as f,k as K,p as O,c as Q,a as _,x as X,d as t,w as o,j as n,e as r,t as Z,v as ee,b as te,F as le,o as V,g as u}from"./index-BrJsWRuD.js";import{u as oe,a as ae}from"./usePagination-BOaze3gY.js";import{u as re}from"./useCrud-DQNCJ6PL.js";const ne={class:"mb-4 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"},de={class:"order-1 sm:order-2 text-center"},se={class:"overflow-auto"},ce={__name:"DailyRevenue",setup(ie){const k=I(),{dialogWidth:C}=oe(),v=g(),a=J({visible:!1,isEdit:!1,title:"",form:{createdAt:"",price:0,note:"",createdBy:""}}),M={createdAt:[{required:!0,message:"請選擇日期",trigger:"blur"}],price:[{required:!0,message:"請輸入營業額",trigger:"blur"}],createdBy:[{required:!0,message:"請輸入登錄者",trigger:"blur"}]},{loading:x,list:D,fetchData:A,handleAdd:B,handleEdit:w,handleDelete:R,submit:U}=re({getApi:f.getRevenueList,addApi:f.addRevenue,updateApi:f.updateRevenue,deleteApi:f.deleteRevenue,formRef:v,dialog:a,defaultForm:{createdAt:c().format("YYYY-MM-DD"),price:0,note:"",createdBy:k.name},getTitle:d=>d==="add"?"新增營業額":"編輯營業額"}),z=g(c().format("YYYY-MM")),m=g(z.value),b=K(()=>D.value.filter(d=>c(d.createdAt).format("YYYY-MM")===m.value)),{currentPage:L,pageSize:S,pagedList:h,handlePageChange:N}=ae(b,8),P=(d,e,s)=>c(s).format("YYYY-MM-DD"),$=d=>"NT$ "+d.price.toLocaleString();return O(()=>{A()}),(d,e)=>{const s=r("el-button"),Y=r("el-date-picker"),i=r("el-table-column"),j=r("el-table"),q=r("el-pagination"),E=r("el-card"),p=r("el-form-item"),F=r("el-input-number"),y=r("el-input"),T=r("el-form"),W=r("el-dialog"),G=ee("loading");return V(),Q(le,null,[_("header",ne,[t(s,{onClick:n(B),type:"primary",class:"order-2 sm:order-1"},{default:o(()=>e[7]||(e[7]=[u("新增營業額")])),_:1},8,["onClick"]),_("h3",de,Z(m.value)+" 營業額",1),t(Y,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),type:"month",size:"large",format:"YYYY-MM","value-format":"YYYY-MM",clearable:!1,class:"order-3"},null,8,["modelValue"])]),X((V(),te(E,{"element-loading-text":"載入中，請稍候..."},{default:o(()=>[_("div",se,[t(j,{data:n(h),class:"mb-4 min-w-[800px]",stripe:""},{default:o(()=>[t(i,{prop:"createdAt",label:"日期",formatter:P}),t(i,{prop:"price",label:"營業額",formatter:$}),t(i,{prop:"note",label:"備註"}),t(i,{prop:"createdBy",label:"登錄者"}),t(i,{label:"操作"},{default:o(({row:l})=>[t(s,{onClick:H=>n(w)(l),type:"primary"},{default:o(()=>e[8]||(e[8]=[u("編輯")])),_:2},1032,["onClick"]),t(s,{onClick:H=>n(R)(l.id),type:"danger"},{default:o(()=>e[9]||(e[9]=[u("刪除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),t(q,{background:"",layout:"prev, pager, next","page-size":n(S),"current-page":n(L),total:b.value.length,onCurrentChange:n(N)},null,8,["page-size","current-page","total","onCurrentChange"])]),_:1})),[[G,n(x)]]),t(W,{modelValue:a.visible,"onUpdate:modelValue":e[6]||(e[6]=l=>a.visible=l),title:a.title,class:"responsive-dialog",width:n(C)},{footer:o(()=>[t(s,{onClick:e[5]||(e[5]=l=>a.visible=!1)},{default:o(()=>e[10]||(e[10]=[u("取消")])),_:1}),t(s,{onClick:n(U),type:"primary"},{default:o(()=>e[11]||(e[11]=[u("確認")])),_:1},8,["onClick"])]),default:o(()=>[t(T,{model:a.form,rules:M,ref_key:"formRef",ref:v,"label-width":"80px","label-position":"right"},{default:o(()=>[t(p,{prop:"createdAt",label:"選擇日期"},{default:o(()=>[t(Y,{modelValue:a.form.createdAt,"onUpdate:modelValue":e[1]||(e[1]=l=>a.form.createdAt=l),"value-format":"YYYY-MM-DD",placeholder:"請選擇日期"},null,8,["modelValue"])]),_:1}),t(p,{prop:"price",label:"營業額"},{default:o(()=>[t(F,{modelValue:a.form.price,"onUpdate:modelValue":e[2]||(e[2]=l=>a.form.price=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"備註"},{default:o(()=>[t(y,{modelValue:a.form.note,"onUpdate:modelValue":e[3]||(e[3]=l=>a.form.note=l),type:"textarea"},null,8,["modelValue"])]),_:1}),t(p,{prop:"createdBy",label:"登錄者"},{default:o(()=>[t(y,{modelValue:a.form.createdBy,"onUpdate:modelValue":e[4]||(e[4]=l=>a.form.createdBy=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","width"])],64)}}};export{ce as default};
