import{_ as A,u as E,r as i,c as j,a as c,b as R,d as r,w as o,e as t,f as N,o as _,g as f,h as w,E as g}from"./index-DOr8tRSC.js";const I={class:"background flex justify-center items-center"},z={class:"auth-wrapper"},M={class:"flex gap-4 justify-center items-center mb-6"},T={__name:"Login",setup(D){const U=E(),L=N(),m=i(!1),v=()=>{m.value=!m.value},V=i(null),l=i({name:"",username:"",password:"",confirmPassword:""}),C={name:[{required:!0,message:"請輸入用戶名稱",trigger:"blur"},{min:3,max:10,message:"用戶名稱必須為 3 - 10 個字",trigger:"blur"}],username:[{required:!0,message:"請輸入帳號",trigger:"blur"},{min:5,max:20,message:"帳號必須為 5 - 20 個字",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:5,max:20,message:"密碼必須為 5 - 20 個字",trigger:"blur"}],confirmPassword:[{required:!0,message:"請再次輸入密碼",trigger:"blur"},{validator:(n,e,p)=>{e!==l.value.password?p(new Error("兩次輸入的密碼不一致")):p()},trigger:"blur"}]},k=i(null),u=i({username:"",password:""}),P={username:[{required:!0,message:"請輸入帳號",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"}]},q=async()=>{try{await V.value.validate(),await w.register(l.value),m.value=!1,g.success("註冊成功")}catch(n){if(typeof n=="object")return;g.error(n)}},B=async()=>{try{await k.value.validate();const n=await w.login(u.value);localStorage.setItem("token",n);const e=await w.getProfile();U.setUser(e),g.success("登入成功"),L.push("/home")}catch(n){g.error(n)}};return(n,e)=>{const p=t("ShoppingBag"),F=t("el-icon"),d=t("el-input"),a=t("el-form-item"),y=t("el-button"),h=t("ArrowLeft"),x=t("el-link"),b=t("el-form"),S=t("ArrowRight");return _(),j("div",I,[c("div",z,[c("header",M,[r(F,{size:"30"},{default:o(()=>[r(p)]),_:1}),e[6]||(e[6]=c("h2",null,"樂器行後台系統",-1))]),m.value?(_(),R(b,{key:0,ref_key:"registerFormRef",ref:V,model:l.value,rules:C},{default:o(()=>[r(a,{prop:"name"},{default:o(()=>[r(d,{modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.name=s),"prefix-icon":"Postcard",placeholder:"請輸入用戶名稱"},null,8,["modelValue"])]),_:1}),r(a,{prop:"username"},{default:o(()=>[r(d,{modelValue:l.value.username,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.username=s),"prefix-icon":"User",placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1}),r(a,{prop:"password"},{default:o(()=>[r(d,{modelValue:l.value.password,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.password=s),"prefix-icon":"Lock",type:"password",placeholder:"請輸入密碼"},null,8,["modelValue"])]),_:1}),r(a,{prop:"confirmPassword"},{default:o(()=>[r(d,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.confirmPassword=s),"prefix-icon":"Lock",type:"password",placeholder:"確認密碼"},null,8,["modelValue"])]),_:1}),r(a,null,{default:o(()=>[r(y,{type:"primary",onClick:q},{default:o(()=>e[7]||(e[7]=[f("註冊")])),_:1})]),_:1}),r(a,null,{default:o(()=>[r(x,{onClick:v},{default:o(()=>[r(h,{class:"w-4 mr-1"}),e[8]||(e[8]=f("登入"))]),_:1})]),_:1})]),_:1},8,["model"])):(_(),R(b,{key:1,ref_key:"loginFormRef",ref:k,model:u.value,rules:P},{default:o(()=>[r(a,{prop:"username"},{default:o(()=>[r(d,{modelValue:u.value.username,"onUpdate:modelValue":e[4]||(e[4]=s=>u.value.username=s),"prefix-icon":"User",placeholder:"請輸入帳號"},null,8,["modelValue"])]),_:1}),r(a,{prop:"password"},{default:o(()=>[r(d,{modelValue:u.value.password,"onUpdate:modelValue":e[5]||(e[5]=s=>u.value.password=s),"prefix-icon":"Lock",type:"password",placeholder:"請輸入密碼"},null,8,["modelValue"])]),_:1}),r(a,null,{default:o(()=>[r(y,{type:"primary",onClick:B},{default:o(()=>e[9]||(e[9]=[f("登入")])),_:1})]),_:1}),r(a,null,{default:o(()=>[r(x,{onClick:v},{default:o(()=>[r(S,{class:"w-4 mr-1"}),e[10]||(e[10]=f("註冊帳號"))]),_:1})]),_:1})]),_:1},8,["model"]))])])}}},H=A(T,[["__scopeId","data-v-2dc18359"]]);export{H as default};
